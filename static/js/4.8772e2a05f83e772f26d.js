webpackJsonp([4],{"3KXA":function(t,e){},"4FCr":function(t,e,i){"use strict";Boolean,String;var a={name:"load-more",props:{showLoading:{type:Boolean,default:!0},tip:String}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vux-loadmore weui-loadmore",class:{"weui-loadmore_line":!t.showLoading,"weui-loadmore_dot":!t.showLoading&&!t.tip}},[t.showLoading?i("i",{staticClass:"weui-loading"}):t._e(),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.tip||!t.showLoading,expression:"tip || !showLoading"}],staticClass:"weui-loadmore__tips"},[t._v(t._s(t.tip))])])},staticRenderFns:[]};var n=i("VU/8")(a,o,!1,function(t){i("3KXA")},null,null);e.a=n.exports},Ki7E:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("xQHR");var a=i("azEN"),o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page cust2"},[i("div",{staticClass:"customer2 step2"},[i("vheader",{attrs:{title:t.topinfo.title,isShowHome:!0}}),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"orderlist customer"},[i("ul",[i("li",[i("div",{staticClass:"list-left"},[i("p",{staticClass:"gunno"},[t._v(t._s(t.oilRecord.gunNo)+"#枪")]),t._v(" "),i("span",{staticClass:"gasName"},[t._v(t._s(t.oilRecord.tankOilName))])]),t._v(" "),i("div",{staticClass:"list-right",staticStyle:{padding:"0 8px"}},[i("p",{staticClass:"username"},[i("span",{staticStyle:{"font-size":"22px",color:"#333"}},[t._v(t._s(t.oilRecord.cardOwner))]),t._v("\n              ("+t._s(t._f("substr")(t.oilRecord.cardNo))+")\n            ")]),t._v(" "),i("div",{staticClass:"oildata"},[i("div",{staticClass:"moneybox",staticStyle:{"margin-right":"10px"}},[i("span",{staticClass:"data-value",staticStyle:{"font-size":"18px"}},[t._v("\n                  "+t._s(t.oilRecord.amount)+"\n                  "),i("span",{staticStyle:{"font-size":"14px"}},[t._v("元")])])]),t._v(" "),i("div",{staticClass:"litrebox"},[i("span",{staticClass:"data-value",staticStyle:{color:"#000","font-size":"14px","font-family":"PingFangSC-Medium"}},[t._v(t._s(t.oilRecord.liter)+"L")])]),t._v(" "),i("div",{staticClass:"clear"})]),t._v(" "),i("p",{staticClass:"oiltime"},[t._v(t._s(t.oilRecord.getTimeStr))])]),t._v(" "),i("div",{staticClass:"clear"})]),t._v(" "),i("div",{staticClass:"clear"})])]),t._v(" "),i("div",{staticClass:"payinfo"},[i("ul",[t._l(t.gasStationSalePayListtransform,function(e,a){return t.showtransform?i("li",{key:a},[i("div",{staticClass:"pay-left pay-desc"},[t._v("支付方式")]),t._v(" "),i("div",{staticClass:"pay-right"}),t._v(" "),i("span",{staticClass:"pay-txt"},[t._v(t._s(e.payModeName)+" "+t._s(e.payAmount)+"元")])]):t._e()}),t._v(" "),null!=t.userInfo.plateNum||null!=t.userInfo.phone?i("li",[i("div",{staticClass:"pay-left pay-desc"},[t._v("客户标识")]),t._v(" "),i("div",{staticClass:"pay-right"},[i("span",{staticClass:"pay-txt"},[t._v("\n              "+t._s(t.userInfo.plateNum)+"\n              "),t.userInfo.plateNum&&t.userInfo.phone?i("span",[t._v(",")]):t._e(),t._v("\n              "+t._s(t.userInfo.phone)+"\n            ")])]),t._v(" "),i("div",{staticClass:"clear"})]):t._e(),t._v(" "),i("li",[i("div",{staticClass:"pay-left pay-desc"},[t._v("会员推荐")]),t._v(" "),1==t.userInfo.isMember?i("div",{staticClass:"pay-right member m1"},[i("ul",[i("li",[i("p",{staticClass:"m-desc"},[t._v("本站加油")]),t._v(" "),i("p",{staticClass:"m-txt"},[i("span",{staticClass:"m-value"},[t._v(t._s(t.userInfo.stationTradeCnt))]),t._v("次\n                ")])]),t._v(" "),i("li",[i("p",{staticClass:"m-desc"},[t._v("累计消费")]),t._v(" "),i("p",{staticClass:"m-txt"},[i("span",{staticClass:"m-value"},[t._v(t._s(t.userInfo.stationAmount))]),t._v("元\n                ")])]),t._v(" "),i("li",[i("p",{staticClass:"m-desc"},[t._v("石化加油")]),t._v(" "),i("p",{staticClass:"m-txt"},[i("span",{staticClass:"m-value"},[t._v(t._s(t.userInfo.totalTradeCnt))]),t._v("次\n                ")])]),t._v(" "),i("li",[i("p",{staticClass:"m-desc"},[t._v("累计消费")]),t._v(" "),i("p",{staticClass:"m-txt"},[i("span",{staticClass:"m-value"},[t._v(t._s(t.userInfo.totalAmount))]),t._v("元\n                ")])]),t._v(" "),i("div",{staticClass:"clear"})])]):0==t.userInfo.isMember?i("div",{staticClass:"nomember"},[i("p",[t._v("您尚未关注"+t._s(t.topinfo.province)+"石油微信公众号,请推荐关注")])]):i("div",{staticClass:"pay-right member m1"},[i("load-more",{attrs:{tip:"正在获取会员信息..."}})],1),t._v(" "),i("div",{staticClass:"clear"})]),t._v(" "),1==t.userInfo.isMember?i("li",{staticClass:"zs"},[i("div",{staticClass:"pay-left pay-desc zs-title"},[t._v("消费赠送")]),t._v(" "),i("div",{staticClass:"pay-right member zsinfo"},[i("ul",[i("li",{staticStyle:{"margin-right":"8px"},style:t.bgimg},[i("span",{staticStyle:{"font-size":"14px"}},[t._v("￥")]),t._v(" "),i("span",{staticStyle:{"font-size":"32px"}},[t._v(t._s(t.userInfo.couValue))]),t._v(" "),i("span",{staticStyle:{"font-family":"PingFangSC-Regular, sans-serif"}},[t._v(t._s(t.userInfo.category))])]),t._v(" "),i("li",{staticStyle:{"margin-right":"0"},style:t.bgimg},[i("span",{staticStyle:{"font-size":"32px"}},[t._v(t._s(t.userInfo.points))]),t._v(" "),i("span",{staticStyle:{"font-family":"PingFangSC-Regular, sans-serif"}},[t._v("积分")])])])]),t._v(" "),i("div",{staticClass:"clear"})]):t._e()],2),t._v(" "),i("div",{staticClass:"clear"})]),t._v(" "),i("input",{attrs:{id:"money",value:"210.123"}}),t._v(" "),i("button",{on:{click:function(e){return t.playWeixin()}}},[t._v("play weixin")]),t._v(" "),i("button",{on:{click:function(e){return t.playAlipay()}}},[t._v("play alipay")]),t._v(" "),i("confirm",{attrs:{title:"打印电子发票","confirm-text":"确定","cancel-text":"取消"},on:{"on-cancel":t.cancelConfirmZi,"on-confirm":t.printData},model:{value:t.showConfirm,callback:function(e){t.showConfirm=e},expression:"showConfirm"}}),t._v(" "),i("confirm",{attrs:{title:"识别发票信息","confirm-text":"确定","cancel-text":"取消"},on:{"on-cancel":t.cancelConfirmDz,"on-confirm":t.disInvoice},model:{value:t.showConfirm2,callback:function(e){t.showConfirm2=e},expression:"showConfirm2"}}),t._v(" "),i("loading",{attrs:{show:t.showLoading,text:t.loadingText}})],1),t._v(" "),i("div",[i("yd-button",{staticClass:"save-submit",staticStyle:{background:"#ff6800","font-size":"20px"},attrs:{size:"large"},nativeOn:{click:function(e){return t.invoiceMethod("noauto")}}},[t._v("电子发票")]),t._v(" "),i("yd-button",{staticClass:"save-submit",staticStyle:{background:"#ff6800","font-size":"20px"},attrs:{size:"large"},nativeOn:{click:function(e){return t.invoiceMethod2()}}},[t._v("纸质发票")]),t._v(" "),i("yd-button",{staticClass:"save-submit",staticStyle:{background:"#ff6800","font-size":"20px"},attrs:{size:"large"},nativeOn:{click:function(e){return t.goindex(e)}}},[t._v("继续收银")])],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"step"},[a("ul",[a("li",{staticClass:"selected"},[t._v("1.加油记录")]),t._v(" "),a("li",[a("img",{attrs:{src:i("rW3a"),width:"15",height:"15"}})]),t._v(" "),a("li",{staticClass:"selected"},[t._v("2.收银结算")]),t._v(" "),a("li",[a("img",{attrs:{src:i("rW3a"),width:"15",height:"15"}})]),t._v(" "),a("li",{staticClass:"selected"},[t._v("3.客户识别")]),t._v(" "),a("li",[a("img",{attrs:{src:i("rW3a"),width:"15",height:"15"}})]),t._v(" "),a("li",{staticClass:"selected"},[t._v("4.开具发票")]),t._v(" "),a("div",{staticClass:"clear"})])])}]};var n=function(t){i("wg8W")},s=i("VU/8")(a.a,o,!1,n,null,null);e.default=s.exports},azEN:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__=__webpack_require__("gRE1"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__),__WEBPACK_IMPORTED_MODULE_2__components_common_header__=__webpack_require__("Mitt"),__WEBPACK_IMPORTED_MODULE_3_vux_src_components_load_more_index_vue__=__webpack_require__("4FCr"),__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__=__webpack_require__("Bfwr"),__WEBPACK_IMPORTED_MODULE_5_vux_src_components_confirm_index_vue__=__webpack_require__("62KO"),bgimg1=__webpack_require__("qZt2");__webpack_exports__.a={data:function(){return{topinfo:{title:"",province:""},userInfo:{},bgimg:{backgroundImage:"url("+bgimg1+")"},oilRecord:{},payType:1,recAmount:0,nrecAmount:0,disAmount:0,orderTime:"",payMethod:"",showLoading:!1,loadingText:"",showConfirm:!1,tradeNo:"",way:!1,showConfirm2:!1,showtransform:!1,gasStationSalePayListtransform:[],money:0,wechatpay:0,oilcardpay:0,alipay:0,receipts_icked:""}},created:function(){switch(window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.onBrowserBack,!1)),this.recAmount=this.$route.query.recAmount,this.nrecAmount=this.$route.query.nrecAmount,this.disAmount=this.$route.query.disAmount,this.orderTime=this.$route.query.orderTime,this.oilrecordId=this.$route.query.id,this.tradeNo=this.$route.query.tradeNo,this.payType=parseInt(this.$route.query.payType),this.payType){case 1:this.payMethod="微信支付";break;case 2:this.payMethod="支付宝支付";break;case 3:this.payMethod="银行卡支付";break;case 4:this.payMethod="现金支付";break;case 5:this.payMethod="电子加油券支付";break;case 6:this.payMethod="石化钱包";break;case 7:this.payMethod="翼支付";break;case 8:this.payMethod="和包支付"}this.getOilRecordById(),this.getUserInfo()},mounted:function(){this.topinfo.title=this.$store.state.POS_province,this.topinfo.province=this.$store.state.POS_Official_Accounts,1==this.$localStorage.getStorage("ifPrint")?(this.getInvoiceQRCode(),console.log("开")):console.log("关"),0!=this.$localStorage.getStorage("gasStationSalePayListtransform").length&&(this.showtransform=!0,this.gasStationSalePayListtransform=this.$localStorage.getStorage("gasStationSalePayListtransform"),console.log(this.gasStationSalePayListtransform,"这是取得值"))},destroyed:function(){window.removeEventListener("popstate",this.onBrowserBack,!1)},methods:{cancelConfirmZi:function(){this.showConfirm=!1},cancelConfirmDz:function(){this.showConfirm2=!1},onBrowserBack:function(){history.pushState(null,null,document.URL)},getOilRecordById:function(){var t=this;this.showLoading=!0,this.$http.get("/store/json/refuel_pos/getRefuelMonitorRecordMsg",{"gasStationSaleOrder.redisId":this.$route.query.id}).then(function(e){"success"===e.result&&(t.loadResult=!0,t.oilRecord=e.data),t.showLoading=!1}).catch(function(e){t.showLoading=!1,console.log(e)})},getUserInfo:function(){var t=this,e=this.$localStorage.getStorage("deviceInfo");this.$http.get("/store/json/refuel_pos/getUserInfo",{"gasStationSaleOrder.posNum":e.posno}).then(function(e){"success"===e.result&&null!=e.data?(t.userInfo=e.data,t.userInfo.isMember||setTimeout(function(){t.getUserInfo()},2e3)):setTimeout(function(){t.getUserInfo()},2e3)}).catch(function(t){console.log(t)})},getInvoiceQRCode:function(){var t=this;this.showLoading=!0;var e=this.$store.getters.getOilInfo;console.log(e);var i=this.$route.query.orderId;i||(i=e.orderId),i?this.$http.get("/store/json/refuel_invoice/createQrCode",{"gasStationSaleOrder.orderId":i}).then(function(e){var i="";"success"===e.result&&e.data&&(i=e.data),t.invoice(i),t.showLoading=!1}).catch(function(e){t.invoice(),console.log(e),t.showLoading=!1}):this.$dialog.alert({mes:"开票失败，获取订单号为:"+i})},invoiceMethod:function(t){t&&(this.way=!0),this.showConfirm=!0},invoiceMethod2:function(){var t=this;this.showLoading=!0;var e=this.$route.query.orderId;console.log(e),this.$http.get("/store/json/refuel_pos/getLocalInvoiceMsg",{orderId:e}).then(function(e){console.log(e,99999999),"success"===e.result?(t.showLoading=!1,null!=e.data&&0!=e.data.length?(console.log("有历史开票信息"),t.receipts_icked=e.data,t.$router.push({path:"/invoice_v2",query:{receipts_icked:t.receipts_icked,orderId:t.$route.query.orderId}})):(console.log("开票历史信息为空"),t.showConfirm2=!0)):(console.log("没有历史开票信息或者返回错误信息"),t.$dialog.alert({mes:e.info})),t.showLoading=!1}).catch(function(e){t.showLoading=!1,console.log(e)})},printData:function(){this.getInvoiceQRCode()},disInvoice:function(){var t=this;this.$bridge.qrscan("","",function(e){console.log("识别发票信息 response",e),t.$router.push({path:"/invoice_v2",query:{qrcode:e,orderId:t.$route.query.orderId}})})},invoice:function invoice(invoiceurl){this.invoiceurl=invoiceurl;var logininfo=this.$localStorage.getStorage("logininfo");logininfo=eval("("+logininfo+")");var stationName=logininfo.stationName;if(1==this.$localStorage.getStorage("ifPrint")&&1==this.way){var printkeys=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付方式","加油时间","收银时间","QR","提示"],printData={},guninfo="TTC:"+this.oilRecord.posTtc+"  油枪:"+this.oilRecord.gunNo+"#";printData.title="支付小票",printData.stationName=stationName,printData.tradeNo=this.tradeNo,printData.cardNo=this.oilRecord.cardNo,printData.cardNo=this.oilRecord.cardNo,printData.tankOilName=this.oilRecord.tankOilName,printData.gunNo=guninfo,printData.liter=this.oilRecord.liter+"L",printData.amount="¥"+parseFloat(this.recAmount).toFixed(2),printData.recAmount="¥"+parseFloat(this.recAmount).toFixed(2),printData.nrecAmount="¥"+parseFloat(this.nrecAmount).toFixed(2),printData.disAmount="¥"+parseFloat(this.disAmount).toFixed(2),printData.payMethod="";for(var i=0;i<this.gasStationSalePayListtransform.length;i++){printkeys.splice(-4,0,this.gasStationSalePayListtransform[i].payModeName);for(var j=0;j<printkeys.length;j++)this.gasStationSalePayListtransform[i].payModeName==printkeys[j]&&(printData[printkeys[j]]="¥"+parseFloat(this.gasStationSalePayListtransform[i].payAmount).toFixed(2),console.log(printData,this.gasStationSalePayListtransform[i].payAmount,"for循环里面"+i,NaN+j));console.log(printkeys,"这是printkeys",i)}printData.getTimeStr=this.oilRecord.getTimeStr,printData.orderTime=this.orderTime,printData.QR=this.invoiceurl,printData.text="扫码开电子发票,当月有效";var prints=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(printData).forEach(function(t,e){var i=new Object;i.OilKey=printkeys[e],i.OilValue=t,prints.push(i)}),this.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(prints)))}else if(1==this.$localStorage.getStorage("ifPrint")&&1!=this.way){var _printkeys=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付方式","加油时间","收银时间"],_printData={},_guninfo="TTC:"+this.oilRecord.posTtc+"  油枪:"+this.oilRecord.gunNo+"#";_printData.title="支付小票",_printData.stationName=stationName,_printData.tradeNo=this.tradeNo,_printData.cardNo=this.oilRecord.cardNo,_printData.tankOilName=this.oilRecord.tankOilName,_printData.gunNo=_guninfo,_printData.liter=this.oilRecord.liter+"L",_printData.amount="¥"+parseFloat(this.recAmount).toFixed(2),_printData.recAmount="¥"+parseFloat(this.recAmount).toFixed(2),_printData.nrecAmount="¥"+parseFloat(this.nrecAmount).toFixed(2),_printData.disAmount="¥"+parseFloat(this.disAmount).toFixed(2),_printData.payMethod="";for(var i=0;i<this.gasStationSalePayListtransform.length;i++){_printkeys.splice(-2,0,this.gasStationSalePayListtransform[i].payModeName);for(var j=0;j<_printkeys.length;j++)this.gasStationSalePayListtransform[i].payModeName==_printkeys[j]&&(_printData[_printkeys[j]]="¥"+parseFloat(this.gasStationSalePayListtransform[i].payAmount).toFixed(2),console.log(_printData,this.gasStationSalePayListtransform[i].payAmount,"for循环里面"+i,NaN+j));console.log(_printkeys,"这是printkeys",i)}_printData.getTimeStr=this.oilRecord.getTimeStr,_printData.orderTime=this.orderTime;var _prints=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(_printData).forEach(function(t,e){var i=new Object;i.OilKey=_printkeys[e],i.OilValue=t,_prints.push(i)}),this.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(_prints)))}else if(0==this.$localStorage.getStorage("ifPrint")&&1==this.way){var _printkeys2=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付方式","加油时间","收银时间","QR","提示"],_printData2={},_guninfo2="TTC:"+this.oilRecord.posTtc+"  油枪:"+this.oilRecord.gunNo+"#";_printData2.title="支付小票",_printData2.stationName=stationName,_printData2.tradeNo=this.tradeNo,_printData2.cardNo=this.oilRecord.cardNo,_printData2.tankOilName=this.oilRecord.tankOilName,_printData2.gunNo=_guninfo2,_printData2.liter=this.oilRecord.liter+"L",_printData2.amount="¥"+parseFloat(this.recAmount).toFixed(2),_printData2.recAmount="¥"+parseFloat(this.recAmount).toFixed(2),_printData2.nrecAmount="¥"+parseFloat(this.nrecAmount).toFixed(2),_printData2.disAmount="¥"+parseFloat(this.disAmount).toFixed(2),_printData2.payMethod="";for(var i=0;i<this.gasStationSalePayListtransform.length;i++){_printkeys2.splice(-4,0,this.gasStationSalePayListtransform[i].payModeName);for(var j=0;j<_printkeys2.length;j++)this.gasStationSalePayListtransform[i].payModeName==_printkeys2[j]&&(_printData2[_printkeys2[j]]="¥"+parseFloat(this.gasStationSalePayListtransform[i].payAmount).toFixed(2),console.log(_printData2,this.gasStationSalePayListtransform[i].payAmount,"for循环里面"+i,NaN+j));console.log(_printkeys2,"这是printkeys",i)}_printData2.getTimeStr=this.oilRecord.getTimeStr,_printData2.orderTime=this.orderTime,_printData2.QR=this.invoiceurl,_printData2.text="扫码开电子发票,当月有效";var _prints2=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(_printData2).forEach(function(t,e){var i=new Object;i.OilKey=_printkeys2[e],i.OilValue=t,_prints2.push(i)}),this.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(_prints2)))}},goindex:function(){this.$router.replace("/orderv2/selectOrder")},playWeixin:function(){this.$Movice.playWeixin(100)},playAlipay:function(){this.$Movice.playAlipay(200)}},components:{vheader:__WEBPACK_IMPORTED_MODULE_2__components_common_header__.a,LoadMore:__WEBPACK_IMPORTED_MODULE_3_vux_src_components_load_more_index_vue__.a,loading:__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__.a,confirm:__WEBPACK_IMPORTED_MODULE_5_vux_src_components_confirm_index_vue__.a},filters:{substr:function(t){return t?t.substring(t.length-6,t.length):""}}}},qZt2:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAX4AAACiCAMAAABxj1YuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGNzdGMTE3NDA3MjA2ODExOTEwOTg1NEM5NEMyM0YyNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBQTY3NjJGQzRFOTkxMUU5OTA2NkE2RkYwODcwNkM4RCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBQTY3NjJGQjRFOTkxMUU5OTA2NkE2RkYwODcwNkM4RCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNS41IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MkZGMEUyMzA0MDc5MTFFOUFGM0U5MzczMDc1M0FEMDYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MkZGMEUyMzE0MDc5MTFFOUFGM0U5MzczMDc1M0FEMDYiLz4gPC9yZGY6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"},wg8W:function(t,e){},xQHR:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__=__webpack_require__("gRE1"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__),__WEBPACK_IMPORTED_MODULE_2__components_common_header__=__webpack_require__("Mitt"),__WEBPACK_IMPORTED_MODULE_3_vux_src_components_load_more_index_vue__=__webpack_require__("4FCr"),__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__=__webpack_require__("Bfwr"),__WEBPACK_IMPORTED_MODULE_5_vux_src_components_confirm_index_vue__=__webpack_require__("62KO"),bgimg1=__webpack_require__("qZt2"),_unused_webpack_default_export={data:function(){return{topinfo:{title:"",province:""},userInfo:{},bgimg:{backgroundImage:"url("+bgimg1+")"},oilRecord:{},payType:1,recAmount:0,nrecAmount:0,disAmount:0,orderTime:"",payMethod:"",showLoading:!1,loadingText:"",showConfirm:!1,tradeNo:"",way:!1,showConfirm2:!1,showtransform:!1,gasStationSalePayListtransform:[],money:0,wechatpay:0,oilcardpay:0,alipay:0,receipts_icked:""}},created:function(){switch(window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.onBrowserBack,!1)),this.recAmount=this.$route.query.recAmount,this.nrecAmount=this.$route.query.nrecAmount,this.disAmount=this.$route.query.disAmount,this.orderTime=this.$route.query.orderTime,this.oilrecordId=this.$route.query.id,this.tradeNo=this.$route.query.tradeNo,this.payType=parseInt(this.$route.query.payType),this.payType){case 1:this.payMethod="微信支付";break;case 2:this.payMethod="支付宝支付";break;case 3:this.payMethod="银行卡支付";break;case 4:this.payMethod="现金支付";break;case 5:this.payMethod="电子加油券支付";break;case 6:this.payMethod="石化钱包";break;case 7:this.payMethod="翼支付";break;case 8:this.payMethod="和包支付"}this.getOilRecordById(),this.getUserInfo()},mounted:function(){this.topinfo.title=this.$store.state.POS_province,this.topinfo.province=this.$store.state.POS_Official_Accounts,1==this.$localStorage.getStorage("ifPrint")?(this.getInvoiceQRCode(),console.log("开")):console.log("关"),0!=this.$localStorage.getStorage("gasStationSalePayListtransform").length&&(this.showtransform=!0,this.gasStationSalePayListtransform=this.$localStorage.getStorage("gasStationSalePayListtransform"),console.log(this.gasStationSalePayListtransform,"这是取得值"))},destroyed:function(){window.removeEventListener("popstate",this.onBrowserBack,!1)},methods:{cancelConfirmZi:function(){this.showConfirm=!1},cancelConfirmDz:function(){this.showConfirm2=!1},onBrowserBack:function(){history.pushState(null,null,document.URL)},getOilRecordById:function(){var t=this;this.showLoading=!0,this.$http.get("/store/json/refuel_pos/getRefuelMonitorRecordMsg",{"gasStationSaleOrder.redisId":this.$route.query.id}).then(function(e){"success"===e.result&&(t.loadResult=!0,t.oilRecord=e.data),t.showLoading=!1}).catch(function(e){t.showLoading=!1,console.log(e)})},getUserInfo:function(){var t=this,e=this.$localStorage.getStorage("deviceInfo");this.$http.get("/store/json/refuel_pos/getUserInfo",{"gasStationSaleOrder.posNum":e.posno}).then(function(e){"success"===e.result&&null!=e.data?(t.userInfo=e.data,t.userInfo.isMember||setTimeout(function(){t.getUserInfo()},2e3)):setTimeout(function(){t.getUserInfo()},2e3)}).catch(function(t){console.log(t)})},getInvoiceQRCode:function(){var t=this;this.showLoading=!0;var e=this.$store.getters.getOilInfo;console.log(e);var i=this.$route.query.orderId;i||(i=e.orderId),i?this.$http.get("/store/json/refuel_invoice/createQrCode",{"gasStationSaleOrder.orderId":i}).then(function(e){var i="";"success"===e.result&&e.data&&(i=e.data),t.invoice(i),t.showLoading=!1}).catch(function(e){t.invoice(),console.log(e),t.showLoading=!1}):this.$dialog.alert({mes:"开票失败，获取订单号为:"+i})},invoiceMethod:function(t){t&&(this.way=!0),this.showConfirm=!0},invoiceMethod2:function(){var t=this;this.showLoading=!0;var e=this.$route.query.orderId;console.log(e),this.$http.get("/store/json/refuel_pos/getLocalInvoiceMsg",{orderId:e}).then(function(e){console.log(e,99999999),"success"===e.result?(t.showLoading=!1,null!=e.data&&0!=e.data.length?(console.log("有历史开票信息"),t.receipts_icked=e.data,t.$router.push({path:"/invoice_v2",query:{receipts_icked:t.receipts_icked,orderId:t.$route.query.orderId}})):(console.log("开票历史信息为空"),t.showConfirm2=!0)):(console.log("没有历史开票信息或者返回错误信息"),t.$dialog.alert({mes:e.info})),t.showLoading=!1}).catch(function(e){t.showLoading=!1,console.log(e)})},printData:function(){this.getInvoiceQRCode()},disInvoice:function(){var t=this;this.$bridge.qrscan("","",function(e){console.log("识别发票信息 response",e),t.$router.push({path:"/invoice_v2",query:{qrcode:e,orderId:t.$route.query.orderId}})})},invoice:function invoice(invoiceurl){this.invoiceurl=invoiceurl;var logininfo=this.$localStorage.getStorage("logininfo");logininfo=eval("("+logininfo+")");var stationName=logininfo.stationName;if(1==this.$localStorage.getStorage("ifPrint")&&1==this.way){var printkeys=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付方式","加油时间","收银时间","QR","提示"],printData={},guninfo="TTC:"+this.oilRecord.posTtc+"  油枪:"+this.oilRecord.gunNo+"#";printData.title="支付小票",printData.stationName=stationName,printData.tradeNo=this.tradeNo,printData.cardNo=this.oilRecord.cardNo,printData.cardNo=this.oilRecord.cardNo,printData.tankOilName=this.oilRecord.tankOilName,printData.gunNo=guninfo,printData.liter=this.oilRecord.liter+"L",printData.amount="¥"+parseFloat(this.recAmount).toFixed(2),printData.recAmount="¥"+parseFloat(this.recAmount).toFixed(2),printData.nrecAmount="¥"+parseFloat(this.nrecAmount).toFixed(2),printData.disAmount="¥"+parseFloat(this.disAmount).toFixed(2),printData.payMethod="";for(var i=0;i<this.gasStationSalePayListtransform.length;i++){printkeys.splice(-4,0,this.gasStationSalePayListtransform[i].payModeName);for(var j=0;j<printkeys.length;j++)this.gasStationSalePayListtransform[i].payModeName==printkeys[j]&&(printData[printkeys[j]]="¥"+parseFloat(this.gasStationSalePayListtransform[i].payAmount).toFixed(2),console.log(printData,this.gasStationSalePayListtransform[i].payAmount,"for循环里面"+i,NaN+j));console.log(printkeys,"这是printkeys",i)}printData.getTimeStr=this.oilRecord.getTimeStr,printData.orderTime=this.orderTime,printData.QR=this.invoiceurl,printData.text="扫码开电子发票,当月有效";var prints=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(printData).forEach(function(t,e){var i=new Object;i.OilKey=printkeys[e],i.OilValue=t,prints.push(i)}),this.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(prints)))}else if(1==this.$localStorage.getStorage("ifPrint")&&1!=this.way){var _printkeys=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付方式","加油时间","收银时间"],_printData={},_guninfo="TTC:"+this.oilRecord.posTtc+"  油枪:"+this.oilRecord.gunNo+"#";_printData.title="支付小票",_printData.stationName=stationName,_printData.tradeNo=this.tradeNo,_printData.cardNo=this.oilRecord.cardNo,_printData.tankOilName=this.oilRecord.tankOilName,_printData.gunNo=_guninfo,_printData.liter=this.oilRecord.liter+"L",_printData.amount="¥"+parseFloat(this.recAmount).toFixed(2),_printData.recAmount="¥"+parseFloat(this.recAmount).toFixed(2),_printData.nrecAmount="¥"+parseFloat(this.nrecAmount).toFixed(2),_printData.disAmount="¥"+parseFloat(this.disAmount).toFixed(2),_printData.payMethod="";for(var i=0;i<this.gasStationSalePayListtransform.length;i++){_printkeys.splice(-2,0,this.gasStationSalePayListtransform[i].payModeName);for(var j=0;j<_printkeys.length;j++)this.gasStationSalePayListtransform[i].payModeName==_printkeys[j]&&(_printData[_printkeys[j]]="¥"+parseFloat(this.gasStationSalePayListtransform[i].payAmount).toFixed(2),console.log(_printData,this.gasStationSalePayListtransform[i].payAmount,"for循环里面"+i,NaN+j));console.log(_printkeys,"这是printkeys",i)}_printData.getTimeStr=this.oilRecord.getTimeStr,_printData.orderTime=this.orderTime;var _prints=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(_printData).forEach(function(t,e){var i=new Object;i.OilKey=_printkeys[e],i.OilValue=t,_prints.push(i)}),this.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(_prints)))}else if(0==this.$localStorage.getStorage("ifPrint")&&1==this.way){var _printkeys2=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付方式","加油时间","收银时间","QR","提示"],_printData2={},_guninfo2="TTC:"+this.oilRecord.posTtc+"  油枪:"+this.oilRecord.gunNo+"#";_printData2.title="支付小票",_printData2.stationName=stationName,_printData2.tradeNo=this.tradeNo,_printData2.cardNo=this.oilRecord.cardNo,_printData2.tankOilName=this.oilRecord.tankOilName,_printData2.gunNo=_guninfo2,_printData2.liter=this.oilRecord.liter+"L",_printData2.amount="¥"+parseFloat(this.recAmount).toFixed(2),_printData2.recAmount="¥"+parseFloat(this.recAmount).toFixed(2),_printData2.nrecAmount="¥"+parseFloat(this.nrecAmount).toFixed(2),_printData2.disAmount="¥"+parseFloat(this.disAmount).toFixed(2),_printData2.payMethod="";for(var i=0;i<this.gasStationSalePayListtransform.length;i++){_printkeys2.splice(-4,0,this.gasStationSalePayListtransform[i].payModeName);for(var j=0;j<_printkeys2.length;j++)this.gasStationSalePayListtransform[i].payModeName==_printkeys2[j]&&(_printData2[_printkeys2[j]]="¥"+parseFloat(this.gasStationSalePayListtransform[i].payAmount).toFixed(2),console.log(_printData2,this.gasStationSalePayListtransform[i].payAmount,"for循环里面"+i,NaN+j));console.log(_printkeys2,"这是printkeys",i)}_printData2.getTimeStr=this.oilRecord.getTimeStr,_printData2.orderTime=this.orderTime,_printData2.QR=this.invoiceurl,_printData2.text="扫码开电子发票,当月有效";var _prints2=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(_printData2).forEach(function(t,e){var i=new Object;i.OilKey=_printkeys2[e],i.OilValue=t,_prints2.push(i)}),this.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(_prints2)))}},goindex:function(){this.$router.replace("/orderv2/selectOrder")},playWeixin:function(){this.$Movice.playWeixin(100)},playAlipay:function(){this.$Movice.playAlipay(200)}},components:{vheader:__WEBPACK_IMPORTED_MODULE_2__components_common_header__.a,LoadMore:__WEBPACK_IMPORTED_MODULE_3_vux_src_components_load_more_index_vue__.a,loading:__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__.a,confirm:__WEBPACK_IMPORTED_MODULE_5_vux_src_components_confirm_index_vue__.a},filters:{substr:function(t){return t?t.substring(t.length-6,t.length):""}}}}});