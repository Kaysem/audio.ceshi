webpackJsonp([22],{WM6U:function(t,s){},bCCi:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("Mitt"),a=e("Bfwr"),o=(i.a,a.a,{data:function(){return{topinfo:{title:""},oilRecords:[{}],result:!1,showLoading:!1,loadingText:""}},mounted:function(){this.topinfo.title=this.$store.state.POS_province,this.showLoading=!0,this.getOrderList()},methods:{loadList:function(){var t=this;this.$http.get("/store/json/refuel_pos/refresh_record").then(function(s){if(console.log(s),"success"===s.result){t.showLoading=!1,t.result=!0;var e=s.data;t.oilRecords=e,t.$refs.pullrefreshDemo.$emit("ydui.pullrefresh.finishLoad")}else console.log(s),s.status,t.$dialog.alert({mes:s.info});t.showLoading=!1}).catch(function(s){t.showLoading=!1,console.log(s)})},getOrderList:function(){var t=this;this.$nextTick(function(){setTimeout(function(){t.$http.get("/store/json/refuel_pos/refresh_record").then(function(s){console.log(s),"success"===s.result?(t.showLoading=!1,t.result=!0,t.oilRecords=s.data):(console.log(s),s.status,t.$dialog.alert({mes:s.info})),t.showLoading=!1}).catch(function(s){t.showLoading=!1,console.log(s)})},500)})},submit:function(t){var s=this;this.showLoading=!0;var e=this.$localStorage.getStorage("deviceInfo"),i="";i=null===e?1:e.posno,this.$http.get("/store/json/refuel_pos/createBill",{"gasStationSaleOrder.redisId":t.id,"gasStationSaleOrder.posNum":i,"gasStationSaleOrder.recAmount":t.amount,"gasStationSaleOrder.disAmount":"0.00","gasStationSaleOrder.price":t.price,"gasStationSaleOrder.skuName":t.tankOilName,"gasStationSaleOrder.skus":t.tankOilNo+":"+t.liter}).then(function(e){if("success"===e.result){var i={id:t.id,orderId:e.data.orderId,gunNo:t.gunNo,tankOilName:t.tankOilName,cardOwner:t.cardOwner,cardNo:t.cardNo,getTimeStr:t.getTimeStr,liter:t.liter,amount:t.amount};if(!e.data.orderId)return void s.$dialog.alert({mes:"账单锁定失败，createBill 返回orderId为："+e.data.orderId});s.$store.commit("setOilInfo",i),s.$router.push({path:"/order/submitOrder",query:{id:t.id,orderId:e.data.orderId}})}else s.$dialog.alert({mes:e.info});s.showLoading=!1,console.log(e)}).catch(function(t){s.showLoading=!1,console.log(t)})}},components:{vheader:i.a,loading:a.a},filters:{substr:function(t){return t?t.substring(t.length-6,t.length):""}}}),r={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"selectOrder"},[e("vheader",{attrs:{title:t.topinfo.title,isShowHome:!0}}),t._v(" "),t._m(0),t._v(" "),1==t.result?e("div",{staticClass:"orderlist"},[e("yd-backtop"),t._v(" "),e("yd-pullrefresh",{ref:"pullrefreshDemo",attrs:{callback:t.loadList,"show-init-tip":!0}},[e("ul",t._l(t.oilRecords,function(s,i){return e("li",[e("div",{staticClass:"list-left"},[e("p",{staticClass:"gunno"},[t._v("\n              "+t._s(s.gunNo)+"#枪\n            ")]),t._v(" "),e("span",{staticClass:"gasName"},[t._v(t._s(s.tankOilName))])]),t._v(" "),e("div",{staticClass:"list-right"},[e("p",{staticClass:"username"},[t._v(t._s(s.cardOwner)+"("+t._s(t._f("substr")(s.cardNo))+")")]),t._v(" "),e("p",{staticClass:"oiltime"},[t._v(t._s(s.getTimeStr))]),t._v(" "),e("p",{staticClass:"oildata"}),e("div",{staticClass:"litrebox"},[e("span",[t._v("升数")]),t._v(" "),e("span",{staticClass:"data-value"},[t._v(t._s(s.liter)+"L")])]),t._v(" "),e("div",{staticClass:"moneybox"},[e("span",[t._v("金额")]),t._v(" "),e("span",{staticClass:"data-value"},[t._v(t._s(s.amount)+"元")])]),t._v(" "),e("p"),t._v(" "),e("div",{staticClass:"btn"},[e("a",{on:{click:function(e){return t.submit(s)}}},[t._v("结算")])])])])}),0)])],1):t._e(),t._v(" "),e("loading",{attrs:{show:t.showLoading,text:t.loadingText}})],1)},staticRenderFns:[function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"step"},[i("ul",[i("li",{staticClass:"selected"},[t._v("1.加油记录")]),t._v(" "),i("li",[i("img",{attrs:{src:e("+y+B"),width:"15",height:"15"}})]),t._v(" "),i("li",[t._v("2.收银结算")]),t._v(" "),i("li",[i("img",{attrs:{src:e("+y+B"),width:"15",height:"15"}})]),t._v(" "),i("li",[t._v("3.客户识别")]),t._v(" "),i("li",[i("img",{attrs:{src:e("+y+B"),width:"15",height:"15"}})]),t._v(" "),i("li",[t._v("4.开具发票")]),t._v(" "),i("div",{staticClass:"clear"})])])}]};var n=e("VU/8")(o,r,!1,function(t){e("WM6U")},null,null);s.default=n.exports}});