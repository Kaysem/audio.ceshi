webpackJsonp([10],{"7Yhy":function(t,e){},WGHa:function(t,e){},iKCg:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),o=a.n(s),n=a("gRE1"),i=a.n(n),l=a("Mitt"),r=a("ignk"),c=a("Bfwr"),d=(l.a,r.a,c.a,{data:function(){return{topinfo:{title:""},staffWsEmpCardList:[],targetId:"",show1:!1,loaddingText:"",oilcardpay:0,money:0,bankpay:0,wechatpay:0,p1:0,refuelStaffWsOrderList:{},nowdate:"",showbtn:!1}},created:function(){this.beginPosWorkSettle()},mounted:function(){this.topinfo.title=this.$store.state.POS_province},methods:{beginPosWorkSettle:function(){var t=this;this.loaddingText="正在开始班结...";var e=this.$localStorage.getStorage("deviceInfo");this.show1=!0,this.$http.get("/store/json/refuel_pos_ws/beginPosWorkSettle",{pos:e.posno}).then(function(e){"success"===e.result?"1"===e.data.resultMsg?(t.loaddingText="正在班结，请勿离开...",t.listTask()):(t.show1=!1,t.staffWsEmpCardList=e.data.staffWsEmpCardList,t.refuelStaffWsOrderList=e.data.refuelStaffWsOrderList[0],t.nowdate=e.currentTime,e.data.refuelStaffWsPayList.forEach(function(e){switch(e.payMode){case"100":t.money=e.payAmount;break;case"170":t.oilcardpay=e.payAmount;break;case"210":t.wechatpay=e.payAmount;break;case"200":break;default:t.p1=e.payAmount}}),t.showbtn=!0):(t.show1=!1,t.$dialog.alert({mes:e.info,callback:function(){t.$router.push("/index")}}));console.log(e)}).catch(function(e){t.$dialog.alert({mes:"网络繁忙，请稍后再试！"}),t.show1=!1,console.log(e)})},listTask:function(){var t=this,e=this.$localStorage.getStorage("deviceInfo");this.$http.get("/store/json/refuel_pos_ws/listTask",{pos:e.posno}).then(function(e){if("success"===e.result){var a=e.data;a&&0!==a.length?a.forEach(function(e){1===e.status?setTimeout(function(){t.listTask()},1e3):t.getPendingWsData(e.targetId)}):(t.show1=!1,t.$dialog.alert({mes:null===e.info?"网络繁忙，请稍后再试！":e.info}))}else t.show1=!1,t.$dialog.alert({mes:null===e.info?"网络繁忙，请稍后再试！":e.info});console.log(e)}).catch(function(e){t.$dialog.alert({mes:"网络繁忙，请稍后再试！"}),t.show1=!1,console.log(e)})},getPendingWsData:function(t){var e=this,a=this.$localStorage.getStorage("deviceInfo");this.$http.get("/store/json/refuel_pos_ws/getPendingWsData",{pos:a.posno,"gasStationTask.targetId":t}).then(function(t){(console.log(t),"success"===t.result)?(e.staffWsEmpCardList=t.data.staffWsEmpCardList,e.targetId=t.data.gasStationTask.targetId,e.refuelStaffWsOrderList=t.data.refuelStaffWsOrderList[0],e.nowdate=t.currentTime,t.data.refuelStaffWsPayList.forEach(function(t){switch(t.payMode){case"100":e.money=t.payAmount;break;case"170":e.oilcardpay=t.payAmount;break;case"210":e.wechatpay=t.payAmount;break;case"200":break;default:e.p1=t.payAmount}}),e.showbtn=!0):e.$dialog.alert({mes:t.info,callback:function(){e.$router.push("/index")}});e.show1=!1}).catch(function(t){e.$dialog.alert({mes:"网络繁忙，请稍后再试！"}),e.show1=!1,console.log(t)})},acceptWsData:function(){var t=this;this.$dialog.confirm({title:'<div style="text-align: center;">温馨提示</div>',mes:'<div style="text-align: center;">确定要完成交班吗？</div>',opts:[{txt:"取消",color:!1,callback:function(){}},{txt:"确定",color:!0,callback:function(){var e=t.$localStorage.getStorage("deviceInfo");t.$dialog.loading.open("正在交班，请稍后..."),t.$http.get("/store/json/refuel_pos_ws/acceptWsData",{pos:e.posno,"gasStationTask.targetId":t.targetId}).then(function(e){if(console.log(e),"success"===e.result){var a=["title","班次","加油笔数","加油卡支付","现金支付","银行卡支付","微信支付","其他支付","合计应收","实收金额","差额"],s={title:"交班明细"};s.workNo=t.refuelStaffWsOrderList.workNo,s.billCount=t.refuelStaffWsOrderList.billCount,s.oilcardpay=t.oilcardpay,s.money=t.money,s.bankpay=t.bankpay,s.wechatpay=t.wechatpay,s.p1=t.p1,s.recAmount=t.refuelStaffWsOrderList.recAmount,s.nrecAmount=t.refuelStaffWsOrderList.nrecAmount,s.chaAmount=t.refuelStaffWsOrderList.chaAmount;var n=[];i()(s).forEach(function(t,e){var s=new Object;s.OilKey=a[e],s.OilValue=t,n.push(s)}),t.$dialog.alert({mes:"交班成功",callback:function(){t.$bridge.printdata(encodeURIComponent(o()(n))),t.$router.push("/index")}})}else t.$dialog.alert({mes:e.info});t.$dialog.loading.close()}).catch(function(e){t.$dialog.alert({mes:"网络繁忙，请稍后再试！"}),console.log(e),t.$dialog.loading.close()})}}]})}},components:{vheader:l.a,XTable:r.a,Loading:c.a},filters:{substr:function(t){return t?t.substring(t.length-6,t.length):""},timetodate:function(t){return t?t.substring(0,t.indexOf(" ")):""}}}),f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page handover-page"},[a("div",{staticClass:"handover"},[a("vheader",{attrs:{title:t.topinfo.title,isShowSignup:!0,isShowHome:!0}}),t._v(" "),""!=t.nowdate?a("div",{staticClass:"top-date"},[t._v(t._s(t._f("timetodate")(t.nowdate)))]):t._e(),t._v(" "),a("div",{staticClass:"data-table"},[t._m(0),t._v(" "),a("div",{staticClass:"data-grid"},[a("x-table",{staticStyle:{"background-color":"#fff"},attrs:{"cell-bordered":!1,"content-bordered":!0}},[a("thead",[a("tr",[a("th",[t._v("卡号")]),t._v(" "),a("th",{staticStyle:{width:"40%"}},[t._v("接班余额/当前余额")]),t._v(" "),a("th",[t._v("加油量")]),t._v(" "),a("th",[t._v("加油金额")])])]),t._v(" "),a("tbody",t._l(t.staffWsEmpCardList,function(e){return a("tr",[a("td",[t._v(t._s(t._f("substr")(e.cardNo)))]),t._v(" "),a("td",{staticStyle:{width:"40%"}},[a("div",{staticClass:"tbody-line"},[t._v(t._s(e.handBalance))]),t._v(" "),a("div",{staticClass:"tbody-line"},[t._v(t._s(e.currentBalance))])]),t._v(" "),a("td",[t._v(t._s(e.payVol))]),t._v(" "),a("td",[t._v(t._s(e.payAmount))])])}),0)])],1)]),t._v(" "),a("div",{staticClass:"oilinfo"},[a("ul",[a("li",[a("div",{staticClass:"info-left"},[a("p",{staticClass:"info-txt"},[t._v("加油笔数")]),t._v(" "),a("p",{staticClass:"info-value"},[t._v(t._s(null==t.refuelStaffWsOrderList.billCount?0:t.refuelStaffWsOrderList.billCount))])]),t._v(" "),a("div",{staticClass:"info-right"},[a("p",{staticClass:"info-txt"},[t._v("应收金额(元)")]),t._v(" "),a("p",{staticClass:"info-value"},[t._v(t._s(null==t.refuelStaffWsOrderList.recAmount?0:t.refuelStaffWsOrderList.recAmount))])])]),t._v(" "),a("li",[a("div",{staticClass:"info-left"},[a("p",{staticClass:"info-txt"},[t._v("实收金额(元)")]),t._v(" "),a("p",{staticClass:"info-value"},[t._v(t._s(null==t.refuelStaffWsOrderList.nrecAmount?0:t.refuelStaffWsOrderList.nrecAmount))])]),t._v(" "),a("div",{staticClass:"info-right"},[a("p",{staticClass:"info-txt"},[t._v("差额(元)")]),t._v(" "),a("p",{staticClass:"info-value"},[t._v(t._s(null==t.refuelStaffWsOrderList.chaAmount?0:t.refuelStaffWsOrderList.chaAmount))])])]),t._v(" "),a("div",{staticClass:"clear"})])]),t._v(" "),a("div",{staticClass:"oilpayinfo"},[a("ul",[a("li",[t._v("加油卡支付"),a("span",{staticClass:"payinfo-value"},[t._v(t._s(t.oilcardpay))])]),t._v(" "),a("li",[t._v("现金支付"),a("span",{staticClass:"payinfo-value"},[t._v(t._s(t.money))])]),t._v(" "),a("li",[t._v("银行卡支付"),a("span",{staticClass:"payinfo-value"},[t._v(t._s(t.bankpay))])]),t._v(" "),a("li",[t._v("微信支付"),a("span",{staticClass:"payinfo-value"},[t._v(t._s(t.wechatpay))])]),t._v(" "),a("li",[t._v("其他"),a("span",{staticClass:"payinfo-value"},[t._v(t._s(t.p1))])])]),t._v(" "),a("div",{staticClass:"clear"})])],1),t._v(" "),a("loading",{attrs:{show:t.show1,text:t.loaddingText}}),t._v(" "),a("footer",{directives:[{name:"show",rawName:"v-show",value:t.showbtn,expression:"showbtn"}],staticClass:"btn-fixed-bottom"},[a("yd-button",{staticClass:"save-submit",attrs:{size:"large",type:"danger"},nativeOn:{click:function(e){return t.acceptWsData(e)}}},[t._v("交班")])],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"table-title"},[e("h2",[this._v("员工卡列表")]),this._v(" "),e("div",{staticClass:"clear"})])}]};var u=a("VU/8")(d,f,!1,function(t){a("7Yhy")},null,null);e.default=u.exports},ignk:function(t,e,a){"use strict";Boolean,Boolean,Boolean;var s={name:"x-table",props:{fullBordered:Boolean,cellBordered:{type:Boolean,default:!0},contentBordered:{type:Boolean,default:!0}}},o={render:function(){var t=this.$createElement;return(this._self._c||t)("table",{staticClass:"vux-table",class:{"vux-table-bordered":this.fullBordered,"vux-table-no-cell-bordered":!this.cellBordered,"vux-table-no-content-bordered":!this.contentBordered}},[this._t("default")],2)},staticRenderFns:[]};var n=a("VU/8")(s,o,!1,function(t){a("WGHa")},null,null);e.a=n.exports}});