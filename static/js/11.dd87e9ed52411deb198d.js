webpackJsonp([11],{"Y/QO":function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__=__webpack_require__("gRE1"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__=__webpack_require__("Gu7T"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_3__components_common_header__=__webpack_require__("Mitt"),__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__=__webpack_require__("Bfwr"),__WEBPACK_IMPORTED_MODULE_5_vux_src_components_datetime_index_vue__=__webpack_require__("UNGY"),__WEBPACK_IMPORTED_MODULE_6_vux_src_components_group_index_vue__=__webpack_require__("rHil"),__WEBPACK_IMPORTED_MODULE_7_vux_src_components_x_button_index_vue__=__webpack_require__("2sLL"),__WEBPACK_IMPORTED_MODULE_8_vux_src_components_popup_picker_index_vue__=__webpack_require__("7Ah8");__webpack_exports__.a={data:function(){return{topinfo:{title:""},showLoading:!1,orderList:[],startdate:"",enddate:"",list:[],defaultValue:["请选择账号"],pageIndex:1,pageSize:5}},mounted:function(){this.topinfo.title=this.$store.state.POS_province,this.getAcctList(),this.queryOrder()},methods:{getAcctList:function(){var e=this;this.$http.get("/store/json/login/getSysOperatorList").then(function(t){if(console.log(t),"success"==t.result){var _=[];t.data.forEach(function(e){var t=e.userName+"("+e.realName+")";_.push(t)}),e.list.push(_)}else e.$dialog.alert({mes:null===t.info?"系统繁忙，请稍后再试!":t.info})}).catch(function(e){console.log(e)})},loadList:function(){var e=this;this.pageIndex=this.pageIndex+1;var t=this.$refs.username.value;t=t.substring(0,t.indexOf("(")),this.$http.getAsJson("/refuel/json/query/queryOrder",{startTime:this.startdate,endTime:this.enddate,userName:t,page:this.pageIndex,rows:10}).then(function(t){if("success"==t.result){t.data.items;var _=t.data.items;if(e.orderList=[].concat(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(e.orderList),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(_)),t.data.page<t.data.totalPage)return e.showLoading=!1,void e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone");e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.finishLoad")}e.showLoading=!1}).catch(function(t){e.showLoading=!1,console.log(t)})},queryOrder:function(){var e=this;this.$nextTick(function(){e.showLoading=!0,setTimeout(function(){var t=e.$refs.username.value;t=t.substring(0,t.indexOf("(")),e.$http.getAsJson("/refuel/json/query/queryOrder",{startTime:e.startdate,endTime:e.enddate,userName:t,page:1,rows:10}).then(function(t){console.log(t),"success"==t.result?e.orderList=t.data.items:e.$dialog.alert({mes:null===t.info?"系统繁忙，请稍后再试!":t.info}),e.showLoading=!1}).catch(function(t){e.showLoading=!1,console.log(t)})},500)})},search:function(){this.showLoading=!0,this.queryOrder()},getInvoiceQRCode:function getInvoiceQRCode(item){var _this4=this;this.showLoading=!0,this.$http.get("/store/json/refuel_invoice/createQrCode",{"gasStationSaleOrder.orderId":item.orderId}).then(function(response){var invoiceurl="";console.log(response),"success"===response.result&&response.data&&(invoiceurl=response.data);var logininfo=_this4.$localStorage.getStorage("logininfo");logininfo=eval("("+logininfo+")");var stationName=logininfo.stationName,printkeys=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付时间","支付方式","提示","QR"],printData={},guninfo="TTC:"+item.posTtc+"  油枪:"+item.gunNo+"#";printData.title="支付小票(补打)",printData.stationName=stationName,printData.tradeNo=item.tradeNo,printData.cardNo=item.cardNo,printData.tankOilName=item.tankOilName,printData.gunNo=guninfo,printData.liter=item.liter+"L",printData.amount="",printData.recAmount="¥"+parseFloat(item.recAmount).toFixed(2),printData.nrecAmount="¥"+parseFloat(item.nrecAmount).toFixed(2),printData.disAmount="¥"+parseFloat(item.disAmount).toFixed(2),printData.getTimeStr=item.payTime,printData.payMethod="";for(var i=0;i<item.payList.length;i++){printkeys.splice(-2,0,item.payList[i].payModeName);for(var j=0;j<printkeys.length;j++)item.payList[i].payModeName==printkeys[j]&&(printData[printkeys[j]]="¥"+parseFloat(item.payList[i].payAmount).toFixed(2),console.log(printData,item.payList[i].payAmount,"for循环里面"+i,NaN+j));console.log(printkeys,"这是printkeys",i)}printData.text="扫码开电子发票,当月有效",printData.QR=invoiceurl,console.log(printData,"对象");var prints=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(printData).forEach(function(e,t){var _=new Object;_.OilKey=printkeys[t],_.OilValue=e,prints.push(_)}),_this4.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(prints))),_this4.showLoading=!1}).catch(function(e){console.log(e),_this4.showLoading=!1})},printData:function(e){var t=this;this.$dialog.confirm({title:'<div style="text-align: center;">提示</div>',mes:'<div style="text-align: center;">是否补打小票?</div>',opts:[{txt:"否",color:!1,callback:function(){console.log("取消补打小票")}},{txt:"是",color:!0,callback:function(){t.getInvoiceQRCode(e)}}]})},change:function(e){this.$refs.username.value=e,console.log("change",this.$refs.username.value)},setToday:function(e){var t=new Date,_=t.getMonth()+1,i=t.getDate();_<10&&(_="0"+_),i<10&&(i="0"+i),this.value7=t.getFullYear()+"-"+_+"-"+i,console.log("set today ok")}},components:{vheader:__WEBPACK_IMPORTED_MODULE_3__components_common_header__.a,loading:__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__.a,Datetime:__WEBPACK_IMPORTED_MODULE_5_vux_src_components_datetime_index_vue__.a,Group:__WEBPACK_IMPORTED_MODULE_6_vux_src_components_group_index_vue__.a,XButton:__WEBPACK_IMPORTED_MODULE_7_vux_src_components_x_button_index_vue__.a,PopupPicker:__WEBPACK_IMPORTED_MODULE_8_vux_src_components_popup_picker_index_vue__.a}}},"oLq+":function(e,t,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});_("pFLw");var i=_("Y/QO"),a={render:function(){var e=this,t=e.$createElement,_=e._self._c||t;return _("div",{staticClass:"queryorder"},[_("vheader",{attrs:{title:e.topinfo.title,isShowHome:!0}}),e._v(" "),_("div",{staticClass:"searchbox"},[_("group",{staticClass:"startdate-group"},[_("popup-picker",{attrs:{data:e.list,"value-text-align":"left"},on:{"on-change":e.change},model:{value:e.defaultValue,callback:function(t){e.defaultValue=t},expression:"defaultValue"}}),e._v(" "),_("input",{ref:"username",attrs:{type:"hidden"}})],1),e._v(" "),_("span",{staticClass:"searchbtn",on:{click:e.search}},[e._v("查询")]),e._v(" "),_("div",{staticClass:"clear"})],1),e._v(" "),_("div",{staticClass:"content",staticStyle:{"margin-top":"50px",padding:"2px 10px"}},[_("yd-infinitescroll",{ref:"infinitescrollDemo",attrs:{callback:e.loadList}},[e._l(e.orderList,function(t,i){return _("ul",{key:i,staticClass:"orderlist",attrs:{slot:"list"},slot:"list"},[_("li",[_("div",{staticClass:"order-data-left order-data-desc"},[e._v("订单号")]),e._v(" "),_("div",{staticClass:"order-data-right"},[e._v(e._s(t.tradeNo))]),e._v(" "),_("div",{staticClass:"clear"})]),e._v(" "),_("li",[_("div",{staticClass:"order-data-left order-data-desc"},[e._v("加油员姓名")]),e._v(" "),_("div",{staticClass:"order-data-right"},[e._v(e._s(t.itemList[0].cashierName))]),e._v(" "),_("div",{staticClass:"clear"})]),e._v(" "),_("li",[_("div",{staticClass:"order-data-left order-data-desc"},[e._v("油品信息")]),e._v(" "),_("div",{staticClass:"order-data-right"},[e._v(e._s(t.payAmount)+"元   "+e._s(t.tankOilName))]),e._v(" "),_("div",{staticClass:"clear"})]),e._v(" "),_("li",[_("div",{staticClass:"order-data-left order-data-desc"},[e._v("加油卡号")]),e._v(" "),_("div",{staticClass:"order-data-right"},[e._v(e._s(t.cardNo))]),e._v(" "),_("div",{staticClass:"clear"})]),e._v(" "),_("li",[_("div",{staticClass:"order-data-left order-data-desc"},[e._v("支付时间")]),e._v(" "),_("div",{staticClass:"order-data-right"},[e._v(e._s(e._f("time")(t.payList[0].payTime/1e3)))]),e._v(" "),_("div",{staticClass:"clear"})]),e._v(" "),_("li",[_("div",{staticClass:"order-data-left order-data-desc"},[e._v("枪号")]),e._v(" "),_("div",{staticClass:"order-data-right"},[e._v(e._s(t.gunNo))]),e._v(" "),_("div",{staticClass:"clear"})]),e._v(" "),e._l(t.payList,function(t,i){return _("li",{key:i},[_("div",{staticClass:"order-data-left order-data-desc"},[e._v(e._s(t.payModeName))]),e._v(" "),_("div",{staticClass:"order-data-right"},[e._v(e._s(t.payAmount)+"元")]),e._v(" "),_("div",{staticClass:"clear"})])}),e._v(" "),_("li",{staticClass:"printbtn",on:{click:function(_){return e.printData(t)}}},[e._v("补打小票")]),e._v(" "),_("div",{staticClass:"clear"})],2)}),e._v(" "),_("span",{attrs:{slot:"doneTip"},slot:"doneTip"},[e._v("没有数据啦~~")])],2)],1),e._v(" "),_("loading",{attrs:{show:e.showLoading,text:""}})],1)},staticRenderFns:[]};var n=function(e){_("sDqq")},o=_("VU/8")(i.a,a,!1,n,null,null);t.default=o.exports},pFLw:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__=__webpack_require__("gRE1"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__=__webpack_require__("Gu7T"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_3__components_common_header__=__webpack_require__("Mitt"),__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__=__webpack_require__("Bfwr"),__WEBPACK_IMPORTED_MODULE_5_vux_src_components_datetime_index_vue__=__webpack_require__("UNGY"),__WEBPACK_IMPORTED_MODULE_6_vux_src_components_group_index_vue__=__webpack_require__("rHil"),__WEBPACK_IMPORTED_MODULE_7_vux_src_components_x_button_index_vue__=__webpack_require__("2sLL"),__WEBPACK_IMPORTED_MODULE_8_vux_src_components_popup_picker_index_vue__=__webpack_require__("7Ah8"),_unused_webpack_default_export={data:function(){return{topinfo:{title:""},showLoading:!1,orderList:[],startdate:"",enddate:"",list:[],defaultValue:["请选择账号"],pageIndex:1,pageSize:5}},mounted:function(){this.topinfo.title=this.$store.state.POS_province,this.getAcctList(),this.queryOrder()},methods:{getAcctList:function(){var e=this;this.$http.get("/store/json/login/getSysOperatorList").then(function(t){if(console.log(t),"success"==t.result){var _=[];t.data.forEach(function(e){var t=e.userName+"("+e.realName+")";_.push(t)}),e.list.push(_)}else e.$dialog.alert({mes:null===t.info?"系统繁忙，请稍后再试!":t.info})}).catch(function(e){console.log(e)})},loadList:function(){var e=this;this.pageIndex=this.pageIndex+1;var t=this.$refs.username.value;t=t.substring(0,t.indexOf("(")),this.$http.getAsJson("/refuel/json/query/queryOrder",{startTime:this.startdate,endTime:this.enddate,userName:t,page:this.pageIndex,rows:10}).then(function(t){if("success"==t.result){t.data.items;var _=t.data.items;if(e.orderList=[].concat(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(e.orderList),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(_)),t.data.page<t.data.totalPage)return e.showLoading=!1,void e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone");e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.finishLoad")}e.showLoading=!1}).catch(function(t){e.showLoading=!1,console.log(t)})},queryOrder:function(){var e=this;this.$nextTick(function(){e.showLoading=!0,setTimeout(function(){var t=e.$refs.username.value;t=t.substring(0,t.indexOf("(")),e.$http.getAsJson("/refuel/json/query/queryOrder",{startTime:e.startdate,endTime:e.enddate,userName:t,page:1,rows:10}).then(function(t){console.log(t),"success"==t.result?e.orderList=t.data.items:e.$dialog.alert({mes:null===t.info?"系统繁忙，请稍后再试!":t.info}),e.showLoading=!1}).catch(function(t){e.showLoading=!1,console.log(t)})},500)})},search:function(){this.showLoading=!0,this.queryOrder()},getInvoiceQRCode:function getInvoiceQRCode(item){var _this4=this;this.showLoading=!0,this.$http.get("/store/json/refuel_invoice/createQrCode",{"gasStationSaleOrder.orderId":item.orderId}).then(function(response){var invoiceurl="";console.log(response),"success"===response.result&&response.data&&(invoiceurl=response.data);var logininfo=_this4.$localStorage.getStorage("logininfo");logininfo=eval("("+logininfo+")");var stationName=logininfo.stationName,printkeys=["title","加油站","订单流水","加油卡号","油品","油枪信息","数量","加油金额","应收","实收","优惠金额","支付时间","支付方式","提示","QR"],printData={},guninfo="TTC:"+item.posTtc+"  油枪:"+item.gunNo+"#";printData.title="支付小票(补打)",printData.stationName=stationName,printData.tradeNo=item.tradeNo,printData.cardNo=item.cardNo,printData.tankOilName=item.tankOilName,printData.gunNo=guninfo,printData.liter=item.liter+"L",printData.amount="",printData.recAmount="¥"+parseFloat(item.recAmount).toFixed(2),printData.nrecAmount="¥"+parseFloat(item.nrecAmount).toFixed(2),printData.disAmount="¥"+parseFloat(item.disAmount).toFixed(2),printData.getTimeStr=item.payTime,printData.payMethod="";for(var i=0;i<item.payList.length;i++){printkeys.splice(-2,0,item.payList[i].payModeName);for(var j=0;j<printkeys.length;j++)item.payList[i].payModeName==printkeys[j]&&(printData[printkeys[j]]="¥"+parseFloat(item.payList[i].payAmount).toFixed(2),console.log(printData,item.payList[i].payAmount,"for循环里面"+i,NaN+j));console.log(printkeys,"这是printkeys",i)}printData.text="扫码开电子发票,当月有效",printData.QR=invoiceurl,console.log(printData,"对象");var prints=[];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_values___default()(printData).forEach(function(e,t){var _=new Object;_.OilKey=printkeys[t],_.OilValue=e,prints.push(_)}),_this4.$bridge.printdata(encodeURIComponent(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(prints))),_this4.showLoading=!1}).catch(function(e){console.log(e),_this4.showLoading=!1})},printData:function(e){var t=this;this.$dialog.confirm({title:'<div style="text-align: center;">提示</div>',mes:'<div style="text-align: center;">是否补打小票?</div>',opts:[{txt:"否",color:!1,callback:function(){console.log("取消补打小票")}},{txt:"是",color:!0,callback:function(){t.getInvoiceQRCode(e)}}]})},change:function(e){this.$refs.username.value=e,console.log("change",this.$refs.username.value)},setToday:function(e){var t=new Date,_=t.getMonth()+1,i=t.getDate();_<10&&(_="0"+_),i<10&&(i="0"+i),this.value7=t.getFullYear()+"-"+_+"-"+i,console.log("set today ok")}},components:{vheader:__WEBPACK_IMPORTED_MODULE_3__components_common_header__.a,loading:__WEBPACK_IMPORTED_MODULE_4_vux_src_components_loading_index_vue__.a,Datetime:__WEBPACK_IMPORTED_MODULE_5_vux_src_components_datetime_index_vue__.a,Group:__WEBPACK_IMPORTED_MODULE_6_vux_src_components_group_index_vue__.a,XButton:__WEBPACK_IMPORTED_MODULE_7_vux_src_components_x_button_index_vue__.a,PopupPicker:__WEBPACK_IMPORTED_MODULE_8_vux_src_components_popup_picker_index_vue__.a}}},sDqq:function(e,t){}});